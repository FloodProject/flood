/************************************************************************
*
* vaporEngine by triton © (2008-2009)
*
*	<http://www.portugal-a-programar.org>
*
************************************************************************/

#pragma once

namespace vapor {
	namespace log {

/**
 * HTML markup. We declare it as XHTML Strict. All cool kids are doing it.
 */

static const char LOG_HTML[] =

	"<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\"\n"
		"\t\"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">\n"
	"<html xmlns='http://www.w3.org/1999/xhtml'>\n"
		"<head>\n"
			"\t<meta http-equiv='content-type' content='application/xhtml+xml; charset=utf-8'/>\n"
			"\t<title>%s</title>\n"
			"\t<style type=\"text/css\">\n" "%s" "\t</style>\n"
			"\t<script type=\"text/javascript\" src=\"%s\">\n"
			"\t</script>\n"
		"</head>\n"
		"<body>\n"
			"\t<div id='container'>\n"
				"\t<img id='header' src='head.png' alt=''/>\n"
				"\t<table class='sortable'>\n"
					"\t\t<thead><tr><th></th><th>Time</th><th>Subsystem</th><th>Description</th></tr></thead>\n";

/**
 * CSS styling. This is always a pain in the ass to get working.
 * Only tested in Mozilla Firefox 3.x and Google Chrome.
 */

static const char LOG_CSS[] =

	"\t\t\t* { font: 10px sans-serif; }\n"
	"\t\t\tbody { text-align: center; margin: 0 auto; }\n"
	"\t\t\t#header { margin-top: 10px; margin-bottom:-3px; }\n"
	"\t\t\ttr:nth-child(even) { background-color: #eee; }\n"
	"\t\t\ttable { margin: 0 auto; table-layout: automatic; width: 600px; text-align: left; border: 1px solid black; }\n"
	"\t\t\tthead th { font-weight: bold; font-size: 1.2em; border-bottom: 1px dotted black; }\n"
	"\t\t\ttable tr.even { background-color: #eee; }\n"
	"\t\t\ttable tr.warn { background-color: #ff9; }\n"
	"\t\t\ttable tr.error { background-color: #ff9; }\n"
	"\t\t\ttable td.info { background-repeat: no-repeat; width: 16px; height: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAKcSURBVDjLpZPLa9RXHMU/d0ysZEwmMQqZiTaP0agoaKGJUiwIxU0hUjtUQaIuXHSVbRVc+R8ICj5WvrCldJquhVqalIbOohuZxjDVxDSP0RgzyST9zdzvvffrQkh8tBs9yy9fPhw45xhV5X1U8+Yhc3U0LcEdVxdOVq20OA0ooQjhpnfhzuDZTx6++m9edfDFlZGMtXKxI6HJnrZGGtauAWAhcgwVnnB/enkGo/25859l3wIcvpzP2EhuHNpWF9/dWs/UnKW4EOGDkqhbQyqxjsKzMgM/P1ymhlO5C4ezK4DeS/c7RdzQoa3x1PaWenJjJZwT9rQ1gSp/js1jYoZdyfX8M1/mp7uFaTR8mrt29FEMQILr62jQ1I5kA8OF59jIItVA78dJertTiBNs1ZKfLNG+MUHX1oaURtIHEAOw3p/Y197MWHEJEUGCxwfHj8MTZIcnsGKxzrIURYzPLnJgbxvG2hMrKdjItjbV11CYKeG8R7ygIdB3sBMFhkem0RAAQ3Fuka7UZtRHrasOqhYNilOwrkrwnhCU/ON5/q04vHV48ThxOCuoAbxnBQB+am65QnO8FqMxNCjBe14mpHhxBBGCWBLxD3iyWMaYMLUKsO7WYH6Stk1xCAGccmR/Ozs/bKJuXS39R/YgIjgROloSDA39Deit1SZWotsjD8pfp5ONqZ6uTfyWn+T7X0f59t5fqDhUA4ry0fYtjJcWeZQvTBu4/VqRuk9/l9Fy5cbnX+6Od26s58HjWWaflwkusKGxjm1bmhkvLXHvh1+WMbWncgPfZN+qcvex6xnUXkzvSiYP7EvTvH4toDxdqDD4+ygT+cKMMbH+3MCZ7H9uAaDnqytpVX8cDScJlRY0YIwpAjcNcuePgXP/P6Z30QuoP4J7WbYhuQAAAABJRU5ErkJggg=='); }\n"
	"\t\t\ttable td.warn { background-repeat: no-repeat; width: 16px; height: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAIsSURBVDjLpVNLSJQBEP7+h6uu62vLVAJDW1KQTMrINQ1vPQzq1GOpa9EppGOHLh0kCEKL7JBEhVCHihAsESyJiE4FWShGRmauu7KYiv6Pma+DGoFrBQ7MzGFmPr5vmDFIYj1mr1WYfrHPovA9VVOqbC7e/1rS9ZlrAVDYHig5WB0oPtBI0TNrUiC5yhP9jeF4X8NPcWfopoY48XT39PjjXeF0vWkZqOjd7LJYrmGasHPCCJbHwhS9/F8M4s8baid764Xi0Ilfp5voorpJfn2wwx/r3l77TwZUvR+qajXVn8PnvocYfXYH6k2ioOaCpaIdf11ivDcayyiMVudsOYqFb60gARJYHG9DbqQFmSVNjaO3K2NpAeK90ZCqtgcrjkP9aUCXp0moetDFEeRXnYCKXhm+uTW0CkBFu4JlxzZkFlbASz4CQGQVBFeEwZm8geyiMuRVntzsL3oXV+YMkvjRsydC1U+lhwZsWXgHb+oWVAEzIwvzyVlk5igsi7DymmHlHsFQR50rjl+981Jy1Fw6Gu0ObTtnU+cgs28AKgDiy+Awpj5OACBAhZ/qh2HOo6i+NeA73jUAML4/qWux8mt6NjW1w599CS9xb0mSEqQBEDAtwqALUmBaG5FV3oYPnTHMjAwetlWksyByaukxQg2wQ9FlccaK/OXA3/uAEUDp3rNIDQ1ctSk6kHh1/jRFoaL4M4snEMeD73gQx4M4PsT1IZ5AfYH68tZY7zv/ApRMY9mnuVMvAAAAAElFTkSuQmCC'); }\n"
	"\t\t\ttable td.error { background-repeat: no-repeat; width: 16px; height: 16px; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABGdBTUEAAK/INwWK6QAAABl0RVh0U29mdHdhcmUAQWRvYmUgSW1hZ2VSZWFkeXHJZTwAAAJPSURBVDjLpZPLS5RhFMYfv9QJlelTQZwRb2OKlKuINuHGLlBEBEOLxAu46oL0F0QQFdWizUCrWnjBaDHgThCMoiKkhUONTqmjmDp2GZ0UnWbmfc/ztrC+GbM2dXbv4ZzfeQ7vefKMMfifyP89IbevNNCYdkN2kawkCZKfSPZTOGTf6Y/m1uflKlC3LvsNTWArr9BT2LAf+W73dn5jHclIBFZyfYWU3or7T4K7AJmbl/yG7EtX1BQXNTVCYgtgbAEAYHlqYHlrsTEVQWr63RZFuqsfDAcdQPrGRR/JF5nKGm9xUxMyr0YBAEXXHgIANq/3ADQobD2J9fAkNiMTMSFb9z8ambMAQER3JC1XttkYGGZXoyZEGyTHRuBuPgBTUu7VSnUAgAUAWutOV2MjZGkehgYUA6O5A0AlkAyRnotiX3MLlFKduYCqAtuGXpyH0XQmOj+TIURt51OzURTYZdBKV2UBSsOIcRp/TVTT4ewK6idECAihtUKOArWcjq/B8tQ6UkUR31+OYXP4sTOdisivrkMyHodWejlXwcC38Fvs8dY5xaIId89VlJy7ACpCNCFCuOp8+BJ6A631gANQSg1mVmOxxGQYRW2nHMha4B5WA3chsv22T5/B13AIicWZmNZ6cMchTXUe81Okzz54pLi0uQWp+TmkZqMwxsBV74Or3od4OISPr0e3SHa3PX0f3HXKofNH/UIG9pZ5PeUth+CyS2EMkEqs4fPEOBJLsyske48/+xD8oxcAYPzs4QaS7RR2kbLTTOTQieczfzfTv8QPldGvTGoF6/8AAAAASUVORK5CYII='); }\n";

/**
 * JavaScript table sorting implementation in base64 encoding.
 * TODO: WTF? Decode this shit and include it as text.
 */

static const char LOG_JS_TABLES[] =

	"data:text/javascript;base64,LyoKICBTb3J0VGFibGUKICB2ZXJzaW9uIDIKICA3dG"
	"ggQXByaWwgMjAwNwogIFN0dWFydCBMYW5ncmlkZ2UsIGh0dHA6Ly93d3cua3J5b2dlbml4"
	"Lm9yZy9jb2RlL2Jyb3dzZXIvc29ydHRhYmxlLwogIAogIEluc3RydWN0aW9uczoKICBEb3"
	"dubG9hZCB0aGlzIGZpbGUKICBBZGQgPHNjcmlwdCBzcmM9InNvcnR0YWJsZS5qcyI+PC9z"
	"Y3JpcHQ+IHRvIHlvdXIgSFRNTAogIEFkZCBjbGFzcz0ic29ydGFibGUiIHRvIGFueSB0YW"
	"JsZSB5b3UnZCBsaWtlIHRvIG1ha2Ugc29ydGFibGUKICBDbGljayBvbiB0aGUgaGVhZGVy"
	"cyB0byBzb3J0CiAgCiAgVGhhbmtzIHRvIG1hbnksIG1hbnkgcGVvcGxlIGZvciBjb250cm"
	"lidXRpb25zIGFuZCBzdWdnZXN0aW9ucy4KICBMaWNlbmNlZCBhcyBYMTE6IGh0dHA6Ly93"
	"d3cua3J5b2dlbml4Lm9yZy9jb2RlL2Jyb3dzZXIvbGljZW5jZS5odG1sCiAgVGhpcyBiYX"
	"NpY2FsbHkgbWVhbnM6IGRvIHdoYXQgeW91IHdhbnQgd2l0aCBpdC4KKi8KCiAKdmFyIHN0"
	"SXNJRSA9IC8qQGNjX29uIUAqL2ZhbHNlOwoKc29ydHRhYmxlID0gewogIGluaXQ6IGZ1bm"
	"N0aW9uKCkgewogICAgLy8gcXVpdCBpZiB0aGlzIGZ1bmN0aW9uIGhhcyBhbHJlYWR5IGJl"
	"ZW4gY2FsbGVkCiAgICBpZiAoYXJndW1lbnRzLmNhbGxlZS5kb25lKSByZXR1cm47CiAgIC"
	"AvLyBmbGFnIHRoaXMgZnVuY3Rpb24gc28gd2UgZG9uJ3QgZG8gdGhlIHNhbWUgdGhpbmcg"
	"dHdpY2UKICAgIGFyZ3VtZW50cy5jYWxsZWUuZG9uZSA9IHRydWU7CiAgICAvLyBraWxsIH"
	"RoZSB0aW1lcgogICAgaWYgKF90aW1lcikgY2xlYXJJbnRlcnZhbChfdGltZXIpOwogICAg"
	"CiAgICBpZiAoIWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQgfHwgIWRvY3VtZW50LmdldEVsZW"
	"1lbnRzQnlUYWdOYW1lKSByZXR1cm47CiAgICAKICAgIHNvcnR0YWJsZS5EQVRFX1JFID0g"
	"L14oXGRcZD8pW1wvXC4tXShcZFxkPylbXC9cLi1dKChcZFxkKT9cZFxkKSQvOwogICAgCi"
	"AgICBmb3JFYWNoKGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCd0YWJsZScpLCBm"
	"dW5jdGlvbih0YWJsZSkgewogICAgICBpZiAodGFibGUuY2xhc3NOYW1lLnNlYXJjaCgvXG"
	"Jzb3J0YWJsZVxiLykgIT0gLTEpIHsKICAgICAgICBzb3J0dGFibGUubWFrZVNvcnRhYmxl"
	"KHRhYmxlKTsKICAgICAgfQogICAgfSk7CiAgICAKICB9LAogIAogIG1ha2VTb3J0YWJsZT"
	"ogZnVuY3Rpb24odGFibGUpIHsKICAgIGlmICh0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFt"
	"ZSgndGhlYWQnKS5sZW5ndGggPT0gMCkgewogICAgICAvLyB0YWJsZSBkb2Vzbid0IGhhdm"
	"UgYSB0SGVhZC4gU2luY2UgaXQgc2hvdWxkIGhhdmUsIGNyZWF0ZSBvbmUgYW5kCiAgICAg"
	"IC8vIHB1dCB0aGUgZmlyc3QgdGFibGUgcm93IGluIGl0LgogICAgICB0aGUgPSBkb2N1bW"
	"VudC5jcmVhdGVFbGVtZW50KCd0aGVhZCcpOwogICAgICB0aGUuYXBwZW5kQ2hpbGQodGFi"
	"bGUucm93c1swXSk7CiAgICAgIHRhYmxlLmluc2VydEJlZm9yZSh0aGUsdGFibGUuZmlyc3"
	"RDaGlsZCk7CiAgICB9CiAgICAvLyBTYWZhcmkgZG9lc24ndCBzdXBwb3J0IHRhYmxlLnRI"
	"ZWFkLCBzaWdoCiAgICBpZiAodGFibGUudEhlYWQgPT0gbnVsbCkgdGFibGUudEhlYWQgPS"
	"B0YWJsZS5nZXRFbGVtZW50c0J5VGFnTmFtZSgndGhlYWQnKVswXTsKICAgIAogICAgaWYg"
	"KHRhYmxlLnRIZWFkLnJvd3MubGVuZ3RoICE9IDEpIHJldHVybjsgLy8gY2FuJ3QgY29wZS"
	"B3aXRoIHR3byBoZWFkZXIgcm93cwogICAgCiAgICAvLyBTb3J0dGFibGUgdjEgcHV0IHJv"
	"d3Mgd2l0aCBhIGNsYXNzIG9mICJzb3J0Ym90dG9tIiBhdCB0aGUgYm90dG9tIChhcwogIC"
	"AgLy8gInRvdGFsIiByb3dzLCBmb3IgZXhhbXBsZSkuIFRoaXMgaXMgQiZSLCBzaW5jZSB3"
	"aGF0IHlvdSdyZSBzdXBwb3NlZAogICAgLy8gdG8gZG8gaXMgcHV0IHRoZW0gaW4gYSB0Zm"
	"9vdC4gU28sIGlmIHRoZXJlIGFyZSBzb3J0Ym90dG9tIHJvd3MsCiAgICAvLyBmb3IgYmFj"
	"a3dhcmRzIGNvbXBhdGliaWxpdHksIG1vdmUgdGhlbSB0byB0Zm9vdCAoY3JlYXRpbmcgaX"
	"QgaWYgbmVlZGVkKS4KICAgIHNvcnRib3R0b21yb3dzID0gW107CiAgICBmb3IgKHZhciBp"
	"PTA7IGk8dGFibGUucm93cy5sZW5ndGg7IGkrKykgewogICAgICBpZiAodGFibGUucm93c1"
	"tpXS5jbGFzc05hbWUuc2VhcmNoKC9cYnNvcnRib3R0b21cYi8pICE9IC0xKSB7CiAgICAg"
	"ICAgc29ydGJvdHRvbXJvd3Nbc29ydGJvdHRvbXJvd3MubGVuZ3RoXSA9IHRhYmxlLnJvd3"
	"NbaV07CiAgICAgIH0KICAgIH0KICAgIGlmIChzb3J0Ym90dG9tcm93cykgewogICAgICBp"
	"ZiAodGFibGUudEZvb3QgPT0gbnVsbCkgewogICAgICAgIC8vIHRhYmxlIGRvZXNuJ3QgaG"
	"F2ZSBhIHRmb290LiBDcmVhdGUgb25lLgogICAgICAgIHRmbyA9IGRvY3VtZW50LmNyZWF0"
	"ZUVsZW1lbnQoJ3Rmb290Jyk7CiAgICAgICAgdGFibGUuYXBwZW5kQ2hpbGQodGZvKTsKIC"
	"AgICAgfQogICAgICBmb3IgKHZhciBpPTA7IGk8c29ydGJvdHRvbXJvd3MubGVuZ3RoOyBp"
	"KyspIHsKICAgICAgICB0Zm8uYXBwZW5kQ2hpbGQoc29ydGJvdHRvbXJvd3NbaV0pOwogIC"
	"AgICB9CiAgICAgIGRlbGV0ZSBzb3J0Ym90dG9tcm93czsKICAgIH0KICAgIAogICAgLy8g"
	"d29yayB0aHJvdWdoIGVhY2ggY29sdW1uIGFuZCBjYWxjdWxhdGUgaXRzIHR5cGUKICAgIG"
	"hlYWRyb3cgPSB0YWJsZS50SGVhZC5yb3dzWzBdLmNlbGxzOwogICAgZm9yICh2YXIgaT0w"
	"OyBpPGhlYWRyb3cubGVuZ3RoOyBpKyspIHsKICAgICAgLy8gbWFudWFsbHkgb3ZlcnJpZG"
	"UgdGhlIHR5cGUgd2l0aCBhIHNvcnR0YWJsZV90eXBlIGF0dHJpYnV0ZQogICAgICBpZiAo"
	"IWhlYWRyb3dbaV0uY2xhc3NOYW1lLm1hdGNoKC9cYnNvcnR0YWJsZV9ub3NvcnRcYi8pKS"
	"B7IC8vIHNraXAgdGhpcyBjb2wKICAgICAgICBtdGNoID0gaGVhZHJvd1tpXS5jbGFzc05h"
	"bWUubWF0Y2goL1xic29ydHRhYmxlXyhbYS16MC05XSspXGIvKTsKICAgICAgICBpZiAobX"
	"RjaCkgeyBvdmVycmlkZSA9IG10Y2hbMV07IH0KCSAgICAgIGlmIChtdGNoICYmIHR5cGVv"
	"ZiBzb3J0dGFibGVbInNvcnRfIitvdmVycmlkZV0gPT0gJ2Z1bmN0aW9uJykgewoJICAgIC"
	"AgICBoZWFkcm93W2ldLnNvcnR0YWJsZV9zb3J0ZnVuY3Rpb24gPSBzb3J0dGFibGVbInNv"
	"cnRfIitvdmVycmlkZV07CgkgICAgICB9IGVsc2UgewoJICAgICAgICBoZWFkcm93W2ldLn"
	"NvcnR0YWJsZV9zb3J0ZnVuY3Rpb24gPSBzb3J0dGFibGUuZ3Vlc3NUeXBlKHRhYmxlLGkp"
	"OwoJICAgICAgfQoJICAgICAgLy8gbWFrZSBpdCBjbGlja2FibGUgdG8gc29ydAoJICAgIC"
	"AgaGVhZHJvd1tpXS5zb3J0dGFibGVfY29sdW1uaW5kZXggPSBpOwoJICAgICAgaGVhZHJv"
	"d1tpXS5zb3J0dGFibGVfdGJvZHkgPSB0YWJsZS50Qm9kaWVzWzBdOwoJICAgICAgZGVhbl"
	"9hZGRFdmVudChoZWFkcm93W2ldLCJjbGljayIsIGZ1bmN0aW9uKGUpIHsKCiAgICAgICAg"
	"ICBpZiAodGhpcy5jbGFzc05hbWUuc2VhcmNoKC9cYnNvcnR0YWJsZV9zb3J0ZWRcYi8pIC"
	"E9IC0xKSB7CiAgICAgICAgICAgIC8vIGlmIHdlJ3JlIGFscmVhZHkgc29ydGVkIGJ5IHRo"
	"aXMgY29sdW1uLCBqdXN0IAogICAgICAgICAgICAvLyByZXZlcnNlIHRoZSB0YWJsZSwgd2"
	"hpY2ggaXMgcXVpY2tlcgogICAgICAgICAgICBzb3J0dGFibGUucmV2ZXJzZSh0aGlzLnNv"
	"cnR0YWJsZV90Ym9keSk7CiAgICAgICAgICAgIHRoaXMuY2xhc3NOYW1lID0gdGhpcy5jbG"
	"Fzc05hbWUucmVwbGFjZSgnc29ydHRhYmxlX3NvcnRlZCcsCiAgICAgICAgICAgICAgICAg"
	"ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnc29ydHRhYmxlX3NvcnRlZF"
	"9yZXZlcnNlJyk7CiAgICAgICAgICAgIHRoaXMucmVtb3ZlQ2hpbGQoZG9jdW1lbnQuZ2V0"
	"RWxlbWVudEJ5SWQoJ3NvcnR0YWJsZV9zb3J0ZndkaW5kJykpOwogICAgICAgICAgICBzb3"
	"J0cmV2aW5kID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc3BhbicpOwogICAgICAgICAg"
	"ICBzb3J0cmV2aW5kLmlkID0gInNvcnR0YWJsZV9zb3J0cmV2aW5kIjsKICAgICAgICAgIC"
	"Agc29ydHJldmluZC5pbm5lckhUTUwgPSBzdElzSUUgPyAnJm5ic3A8Zm9udCBmYWNlPSJ3"
	"ZWJkaW5ncyI+NTwvZm9udD4nIDogJyZuYnNwOyYjeDI1QjQ7JzsKICAgICAgICAgICAgdG"
	"hpcy5hcHBlbmRDaGlsZChzb3J0cmV2aW5kKTsKICAgICAgICAgICAgcmV0dXJuOwogICAg"
	"ICAgICAgfQogICAgICAgICAgaWYgKHRoaXMuY2xhc3NOYW1lLnNlYXJjaCgvXGJzb3J0dG"
	"FibGVfc29ydGVkX3JldmVyc2VcYi8pICE9IC0xKSB7CiAgICAgICAgICAgIC8vIGlmIHdl"
	"J3JlIGFscmVhZHkgc29ydGVkIGJ5IHRoaXMgY29sdW1uIGluIHJldmVyc2UsIGp1c3QgCi"
	"AgICAgICAgICAgIC8vIHJlLXJldmVyc2UgdGhlIHRhYmxlLCB3aGljaCBpcyBxdWlja2Vy"
	"CiAgICAgICAgICAgIHNvcnR0YWJsZS5yZXZlcnNlKHRoaXMuc29ydHRhYmxlX3Rib2R5KT"
	"sKICAgICAgICAgICAgdGhpcy5jbGFzc05hbWUgPSB0aGlzLmNsYXNzTmFtZS5yZXBsYWNl"
	"KCdzb3J0dGFibGVfc29ydGVkX3JldmVyc2UnLAogICAgICAgICAgICAgICAgICAgICAgIC"
	"AgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3NvcnR0YWJsZV9zb3J0ZWQnKTsKICAg"
	"ICAgICAgICAgdGhpcy5yZW1vdmVDaGlsZChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2"
	"9ydHRhYmxlX3NvcnRyZXZpbmQnKSk7CiAgICAgICAgICAgIHNvcnRmd2RpbmQgPSBkb2N1"
	"bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgIHNvcnRmd2RpbmQuaW"
	"QgPSAic29ydHRhYmxlX3NvcnRmd2RpbmQiOwogICAgICAgICAgICBzb3J0ZndkaW5kLmlu"
	"bmVySFRNTCA9IHN0SXNJRSA/ICcmbmJzcDxmb250IGZhY2U9IndlYmRpbmdzIj42PC9mb2"
	"50PicgOiAnJm5ic3A7JiN4MjVCRTsnOwogICAgICAgICAgICB0aGlzLmFwcGVuZENoaWxk"
	"KHNvcnRmd2RpbmQpOwogICAgICAgICAgICByZXR1cm47CiAgICAgICAgICB9CiAgICAgIC"
	"AgICAKICAgICAgICAgIC8vIHJlbW92ZSBzb3J0dGFibGVfc29ydGVkIGNsYXNzZXMKICAg"
	"ICAgICAgIHRoZWFkcm93ID0gdGhpcy5wYXJlbnROb2RlOwogICAgICAgICAgZm9yRWFjaC"
	"h0aGVhZHJvdy5jaGlsZE5vZGVzLCBmdW5jdGlvbihjZWxsKSB7CiAgICAgICAgICAgIGlm"
	"IChjZWxsLm5vZGVUeXBlID09IDEpIHsgLy8gYW4gZWxlbWVudAogICAgICAgICAgICAgIG"
	"NlbGwuY2xhc3NOYW1lID0gY2VsbC5jbGFzc05hbWUucmVwbGFjZSgnc29ydHRhYmxlX3Nv"
	"cnRlZF9yZXZlcnNlJywnJyk7CiAgICAgICAgICAgICAgY2VsbC5jbGFzc05hbWUgPSBjZW"
	"xsLmNsYXNzTmFtZS5yZXBsYWNlKCdzb3J0dGFibGVfc29ydGVkJywnJyk7CiAgICAgICAg"
	"ICAgIH0KICAgICAgICAgIH0pOwogICAgICAgICAgc29ydGZ3ZGluZCA9IGRvY3VtZW50Lm"
	"dldEVsZW1lbnRCeUlkKCdzb3J0dGFibGVfc29ydGZ3ZGluZCcpOwogICAgICAgICAgaWYg"
	"KHNvcnRmd2RpbmQpIHsgc29ydGZ3ZGluZC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHNvcn"
	"Rmd2RpbmQpOyB9CiAgICAgICAgICBzb3J0cmV2aW5kID0gZG9jdW1lbnQuZ2V0RWxlbWVu"
	"dEJ5SWQoJ3NvcnR0YWJsZV9zb3J0cmV2aW5kJyk7CiAgICAgICAgICBpZiAoc29ydHJldm"
	"luZCkgeyBzb3J0cmV2aW5kLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoc29ydHJldmluZCk7"
	"IH0KICAgICAgICAgIAogICAgICAgICAgdGhpcy5jbGFzc05hbWUgKz0gJyBzb3J0dGFibG"
	"Vfc29ydGVkJzsKICAgICAgICAgIHNvcnRmd2RpbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVt"
	"ZW50KCdzcGFuJyk7CiAgICAgICAgICBzb3J0ZndkaW5kLmlkID0gInNvcnR0YWJsZV9zb3"
	"J0ZndkaW5kIjsKICAgICAgICAgIHNvcnRmd2RpbmQuaW5uZXJIVE1MID0gc3RJc0lFID8g"
	"JyZuYnNwPGZvbnQgZmFjZT0id2ViZGluZ3MiPjY8L2ZvbnQ+JyA6ICcmbmJzcDsmI3gyNU"
	"JFOyc7CiAgICAgICAgICB0aGlzLmFwcGVuZENoaWxkKHNvcnRmd2RpbmQpOwoKCSAgICAg"
	"ICAgLy8gYnVpbGQgYW4gYXJyYXkgdG8gc29ydC4gVGhpcyBpcyBhIFNjaHdhcnR6aWFuIH"
	"RyYW5zZm9ybSB0aGluZywKCSAgICAgICAgLy8gaS5lLiwgd2UgImRlY29yYXRlIiBlYWNo"
	"IHJvdyB3aXRoIHRoZSBhY3R1YWwgc29ydCBrZXksCgkgICAgICAgIC8vIHNvcnQgYmFzZW"
	"Qgb24gdGhlIHNvcnQga2V5cywgYW5kIHRoZW4gcHV0IHRoZSByb3dzIGJhY2sgaW4gb3Jk"
	"ZXIKCSAgICAgICAgLy8gd2hpY2ggaXMgYSBsb3QgZmFzdGVyIGJlY2F1c2UgeW91IG9ubH"
	"kgZG8gZ2V0SW5uZXJUZXh0IG9uY2UgcGVyIHJvdwoJICAgICAgICByb3dfYXJyYXkgPSBb"
	"XTsKCSAgICAgICAgY29sID0gdGhpcy5zb3J0dGFibGVfY29sdW1uaW5kZXg7CgkgICAgIC"
	"AgIHJvd3MgPSB0aGlzLnNvcnR0YWJsZV90Ym9keS5yb3dzOwoJICAgICAgICBmb3IgKHZh"
	"ciBqPTA7IGo8cm93cy5sZW5ndGg7IGorKykgewoJICAgICAgICAgIHJvd19hcnJheVtyb3"
	"dfYXJyYXkubGVuZ3RoXSA9IFtzb3J0dGFibGUuZ2V0SW5uZXJUZXh0KHJvd3Nbal0uY2Vs"
	"bHNbY29sXSksIHJvd3Nbal1dOwoJICAgICAgICB9CgkgICAgICAgIC8qIElmIHlvdSB3YW"
	"50IGEgc3RhYmxlIHNvcnQsIHVuY29tbWVudCB0aGUgZm9sbG93aW5nIGxpbmUgKi8KCSAg"
	"ICAgICAgLy9zb3J0dGFibGUuc2hha2VyX3NvcnQocm93X2FycmF5LCB0aGlzLnNvcnR0YW"
	"JsZV9zb3J0ZnVuY3Rpb24pOwoJICAgICAgICAvKiBhbmQgY29tbWVudCBvdXQgdGhpcyBv"
	"bmUgKi8KCSAgICAgICAgcm93X2FycmF5LnNvcnQodGhpcy5zb3J0dGFibGVfc29ydGZ1bm"
	"N0aW9uKTsKCSAgICAgICAgCgkgICAgICAgIHRiID0gdGhpcy5zb3J0dGFibGVfdGJvZHk7"
	"CgkgICAgICAgIGZvciAodmFyIGo9MDsgajxyb3dfYXJyYXkubGVuZ3RoOyBqKyspIHsKCS"
	"AgICAgICAgICB0Yi5hcHBlbmRDaGlsZChyb3dfYXJyYXlbal1bMV0pOwoJICAgICAgICB9"
	"CgkgICAgICAgIAoJICAgICAgICBkZWxldGUgcm93X2FycmF5OwoJICAgICAgfSk7CgkgIC"
	"AgfQogICAgfQogIH0sCiAgCiAgZ3Vlc3NUeXBlOiBmdW5jdGlvbih0YWJsZSwgY29sdW1u"
	"KSB7CiAgICAvLyBndWVzcyB0aGUgdHlwZSBvZiBhIGNvbHVtbiBiYXNlZCBvbiBpdHMgZm"
	"lyc3Qgbm9uLWJsYW5rIHJvdwogICAgc29ydGZuID0gc29ydHRhYmxlLnNvcnRfYWxwaGE7"
	"CiAgICBmb3IgKHZhciBpPTA7IGk8dGFibGUudEJvZGllc1swXS5yb3dzLmxlbmd0aDsgaS"
	"srKSB7CiAgICAgIHRleHQgPSBzb3J0dGFibGUuZ2V0SW5uZXJUZXh0KHRhYmxlLnRCb2Rp"
	"ZXNbMF0ucm93c1tpXS5jZWxsc1tjb2x1bW5dKTsKICAgICAgaWYgKHRleHQgIT0gJycpIH"
	"sKICAgICAgICBpZiAodGV4dC5tYXRjaCgvXi0/W6MkpF0/W1xkLC5dKyU/JC8pKSB7CiAg"
	"ICAgICAgICByZXR1cm4gc29ydHRhYmxlLnNvcnRfbnVtZXJpYzsKICAgICAgICB9CiAgIC"
	"AgICAgLy8gY2hlY2sgZm9yIGEgZGF0ZTogZGQvbW0veXl5eSBvciBkZC9tbS95eSAKICAg"
	"ICAgICAvLyBjYW4gaGF2ZSAvIG9yIC4gb3IgLSBhcyBzZXBhcmF0b3IKICAgICAgICAvLy"
	"BjYW4gYmUgbW0vZGQgYXMgd2VsbAogICAgICAgIHBvc3NkYXRlID0gdGV4dC5tYXRjaChz"
	"b3J0dGFibGUuREFURV9SRSkKICAgICAgICBpZiAocG9zc2RhdGUpIHsKICAgICAgICAgIC"
	"8vIGxvb2tzIGxpa2UgYSBkYXRlCiAgICAgICAgICBmaXJzdCA9IHBhcnNlSW50KHBvc3Nk"
	"YXRlWzFdKTsKICAgICAgICAgIHNlY29uZCA9IHBhcnNlSW50KHBvc3NkYXRlWzJdKTsKIC"
	"AgICAgICAgIGlmIChmaXJzdCA+IDEyKSB7CiAgICAgICAgICAgIC8vIGRlZmluaXRlbHkg"
	"ZGQvbW0KICAgICAgICAgICAgcmV0dXJuIHNvcnR0YWJsZS5zb3J0X2RkbW07CiAgICAgIC"
	"AgICB9IGVsc2UgaWYgKHNlY29uZCA+IDEyKSB7CiAgICAgICAgICAgIHJldHVybiBzb3J0"
	"dGFibGUuc29ydF9tbWRkOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8gbG"
	"9va3MgbGlrZSBhIGRhdGUsIGJ1dCB3ZSBjYW4ndCB0ZWxsIHdoaWNoLCBzbyBhc3N1bWUK"
	"ICAgICAgICAgICAgLy8gdGhhdCBpdCdzIGRkL21tIChFbmdsaXNoIGltcGVyaWFsaXNtIS"
	"kgYW5kIGtlZXAgbG9va2luZwogICAgICAgICAgICBzb3J0Zm4gPSBzb3J0dGFibGUuc29y"
	"dF9kZG1tOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dX"
	"JuIHNvcnRmbjsKICB9LAogIAogIGdldElubmVyVGV4dDogZnVuY3Rpb24obm9kZSkgewog"
	"ICAgLy8gZ2V0cyB0aGUgdGV4dCB3ZSB3YW50IHRvIHVzZSBmb3Igc29ydGluZyBmb3IgYS"
	"BjZWxsLgogICAgLy8gc3RyaXBzIGxlYWRpbmcgYW5kIHRyYWlsaW5nIHdoaXRlc3BhY2Uu"
	"CiAgICAvLyB0aGlzIGlzICpub3QqIGEgZ2VuZXJpYyBnZXRJbm5lclRleHQgZnVuY3Rpb2"
	"47IGl0J3Mgc3BlY2lhbCB0byBzb3J0dGFibGUuCiAgICAvLyBmb3IgZXhhbXBsZSwgeW91"
	"IGNhbiBvdmVycmlkZSB0aGUgY2VsbCB0ZXh0IHdpdGggYSBjdXN0b21rZXkgYXR0cmlidX"
	"RlLgogICAgLy8gaXQgYWxzbyBnZXRzIC52YWx1ZSBmb3IgPGlucHV0PiBmaWVsZHMuCiAg"
	"ICAKICAgIGhhc0lucHV0cyA9ICh0eXBlb2Ygbm9kZS5nZXRFbGVtZW50c0J5VGFnTmFtZS"
	"A9PSAnZnVuY3Rpb24nKSAmJgogICAgICAgICAgICAgICAgIG5vZGUuZ2V0RWxlbWVudHNC"
	"eVRhZ05hbWUoJ2lucHV0JykubGVuZ3RoOwogICAgCiAgICBpZiAobm9kZS5nZXRBdHRyaW"
	"J1dGUoInNvcnR0YWJsZV9jdXN0b21rZXkiKSAhPSBudWxsKSB7CiAgICAgIHJldHVybiBu"
	"b2RlLmdldEF0dHJpYnV0ZSgic29ydHRhYmxlX2N1c3RvbWtleSIpOwogICAgfQogICAgZW"
	"xzZSBpZiAodHlwZW9mIG5vZGUudGV4dENvbnRlbnQgIT0gJ3VuZGVmaW5lZCcgJiYgIWhh"
	"c0lucHV0cykgewogICAgICByZXR1cm4gbm9kZS50ZXh0Q29udGVudC5yZXBsYWNlKC9eXH"
	"MrfFxzKyQvZywgJycpOwogICAgfQogICAgZWxzZSBpZiAodHlwZW9mIG5vZGUuaW5uZXJU"
	"ZXh0ICE9ICd1bmRlZmluZWQnICYmICFoYXNJbnB1dHMpIHsKICAgICAgcmV0dXJuIG5vZG"
	"UuaW5uZXJUZXh0LnJlcGxhY2UoL15ccyt8XHMrJC9nLCAnJyk7CiAgICB9CiAgICBlbHNl"
	"IGlmICh0eXBlb2Ygbm9kZS50ZXh0ICE9ICd1bmRlZmluZWQnICYmICFoYXNJbnB1dHMpIH"
	"sKICAgICAgcmV0dXJuIG5vZGUudGV4dC5yZXBsYWNlKC9eXHMrfFxzKyQvZywgJycpOwog"
	"ICAgfQogICAgZWxzZSB7CiAgICAgIHN3aXRjaCAobm9kZS5ub2RlVHlwZSkgewogICAgIC"
	"AgIGNhc2UgMzoKICAgICAgICAgIGlmIChub2RlLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkg"
	"PT0gJ2lucHV0JykgewogICAgICAgICAgICByZXR1cm4gbm9kZS52YWx1ZS5yZXBsYWNlKC"
	"9eXHMrfFxzKyQvZywgJycpOwogICAgICAgICAgfQogICAgICAgIGNhc2UgNDoKICAgICAg"
	"ICAgIHJldHVybiBub2RlLm5vZGVWYWx1ZS5yZXBsYWNlKC9eXHMrfFxzKyQvZywgJycpOw"
	"ogICAgICAgICAgYnJlYWs7CiAgICAgICAgY2FzZSAxOgogICAgICAgIGNhc2UgMTE6CiAg"
	"ICAgICAgICB2YXIgaW5uZXJUZXh0ID0gJyc7CiAgICAgICAgICBmb3IgKHZhciBpID0gMD"
	"sgaSA8IG5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICBpbm5l"
	"clRleHQgKz0gc29ydHRhYmxlLmdldElubmVyVGV4dChub2RlLmNoaWxkTm9kZXNbaV0pOw"
	"ogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGlubmVyVGV4dC5yZXBsYWNlKC9eXHMr"
	"fFxzKyQvZywgJycpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgZGVmYXVsdDoKICAgIC"
	"AgICAgIHJldHVybiAnJzsKICAgICAgfQogICAgfQogIH0sCiAgCiAgcmV2ZXJzZTogZnVu"
	"Y3Rpb24odGJvZHkpIHsKICAgIC8vIHJldmVyc2UgdGhlIHJvd3MgaW4gYSB0Ym9keQogIC"
	"AgbmV3cm93cyA9IFtdOwogICAgZm9yICh2YXIgaT0wOyBpPHRib2R5LnJvd3MubGVuZ3Ro"
	"OyBpKyspIHsKICAgICAgbmV3cm93c1tuZXdyb3dzLmxlbmd0aF0gPSB0Ym9keS5yb3dzW2"
	"ldOwogICAgfQogICAgZm9yICh2YXIgaT1uZXdyb3dzLmxlbmd0aC0xOyBpPj0wOyBpLS0p"
	"IHsKICAgICAgIHRib2R5LmFwcGVuZENoaWxkKG5ld3Jvd3NbaV0pOwogICAgfQogICAgZG"
	"VsZXRlIG5ld3Jvd3M7CiAgfSwKICAKICAvKiBzb3J0IGZ1bmN0aW9ucwogICAgIGVhY2gg"
	"c29ydCBmdW5jdGlvbiB0YWtlcyB0d28gcGFyYW1ldGVycywgYSBhbmQgYgogICAgIHlvdS"
	"BhcmUgY29tcGFyaW5nIGFbMF0gYW5kIGJbMF0gKi8KICBzb3J0X251bWVyaWM6IGZ1bmN0"
	"aW9uKGEsYikgewogICAgYWEgPSBwYXJzZUZsb2F0KGFbMF0ucmVwbGFjZSgvW14wLTkuLV"
	"0vZywnJykpOwogICAgaWYgKGlzTmFOKGFhKSkgYWEgPSAwOwogICAgYmIgPSBwYXJzZUZs"
	"b2F0KGJbMF0ucmVwbGFjZSgvW14wLTkuLV0vZywnJykpOyAKICAgIGlmIChpc05hTihiYi"
	"kpIGJiID0gMDsKICAgIHJldHVybiBhYS1iYjsKICB9LAogIHNvcnRfYWxwaGE6IGZ1bmN0"
	"aW9uKGEsYikgewogICAgaWYgKGFbMF09PWJbMF0pIHJldHVybiAwOwogICAgaWYgKGFbMF"
	"08YlswXSkgcmV0dXJuIC0xOwogICAgcmV0dXJuIDE7CiAgfSwKICBzb3J0X2RkbW06IGZ1"
	"bmN0aW9uKGEsYikgewogICAgbXRjaCA9IGFbMF0ubWF0Y2goc29ydHRhYmxlLkRBVEVfUk"
	"UpOwogICAgeSA9IG10Y2hbM107IG0gPSBtdGNoWzJdOyBkID0gbXRjaFsxXTsKICAgIGlm"
	"IChtLmxlbmd0aCA9PSAxKSBtID0gJzAnK207CiAgICBpZiAoZC5sZW5ndGggPT0gMSkgZC"
	"A9ICcwJytkOwogICAgZHQxID0geSttK2Q7CiAgICBtdGNoID0gYlswXS5tYXRjaChzb3J0"
	"dGFibGUuREFURV9SRSk7CiAgICB5ID0gbXRjaFszXTsgbSA9IG10Y2hbMl07IGQgPSBtdG"
	"NoWzFdOwogICAgaWYgKG0ubGVuZ3RoID09IDEpIG0gPSAnMCcrbTsKICAgIGlmIChkLmxl"
	"bmd0aCA9PSAxKSBkID0gJzAnK2Q7CiAgICBkdDIgPSB5K20rZDsKICAgIGlmIChkdDE9PW"
	"R0MikgcmV0dXJuIDA7CiAgICBpZiAoZHQxPGR0MikgcmV0dXJuIC0xOwogICAgcmV0dXJu"
	"IDE7CiAgfSwKICBzb3J0X21tZGQ6IGZ1bmN0aW9uKGEsYikgewogICAgbXRjaCA9IGFbMF"
	"0ubWF0Y2goc29ydHRhYmxlLkRBVEVfUkUpOwogICAgeSA9IG10Y2hbM107IGQgPSBtdGNo"
	"WzJdOyBtID0gbXRjaFsxXTsKICAgIGlmIChtLmxlbmd0aCA9PSAxKSBtID0gJzAnK207Ci"
	"AgICBpZiAoZC5sZW5ndGggPT0gMSkgZCA9ICcwJytkOwogICAgZHQxID0geSttK2Q7CiAg"
	"ICBtdGNoID0gYlswXS5tYXRjaChzb3J0dGFibGUuREFURV9SRSk7CiAgICB5ID0gbXRjaF"
	"szXTsgZCA9IG10Y2hbMl07IG0gPSBtdGNoWzFdOwogICAgaWYgKG0ubGVuZ3RoID09IDEp"
	"IG0gPSAnMCcrbTsKICAgIGlmIChkLmxlbmd0aCA9PSAxKSBkID0gJzAnK2Q7CiAgICBkdD"
	"IgPSB5K20rZDsKICAgIGlmIChkdDE9PWR0MikgcmV0dXJuIDA7CiAgICBpZiAoZHQxPGR0"
	"MikgcmV0dXJuIC0xOwogICAgcmV0dXJuIDE7CiAgfSwKICAKICBzaGFrZXJfc29ydDogZn"
	"VuY3Rpb24obGlzdCwgY29tcF9mdW5jKSB7CiAgICAvLyBBIHN0YWJsZSBzb3J0IGZ1bmN0"
	"aW9uIHRvIGFsbG93IG11bHRpLWxldmVsIHNvcnRpbmcgb2YgZGF0YQogICAgLy8gc2VlOi"
	"BodHRwOi8vZW4ud2lraXBlZGlhLm9yZy93aWtpL0NvY2t0YWlsX3NvcnQKICAgIC8vIHRo"
	"YW5rcyB0byBKb3NlcGggTmFobWlhcwogICAgdmFyIGIgPSAwOwogICAgdmFyIHQgPSBsaX"
	"N0Lmxlbmd0aCAtIDE7CiAgICB2YXIgc3dhcCA9IHRydWU7CgogICAgd2hpbGUoc3dhcCkg"
	"ewogICAgICAgIHN3YXAgPSBmYWxzZTsKICAgICAgICBmb3IodmFyIGkgPSBiOyBpIDwgdD"
	"sgKytpKSB7CiAgICAgICAgICAgIGlmICggY29tcF9mdW5jKGxpc3RbaV0sIGxpc3RbaSsx"
	"XSkgPiAwICkgewogICAgICAgICAgICAgICAgdmFyIHEgPSBsaXN0W2ldOyBsaXN0W2ldID"
	"0gbGlzdFtpKzFdOyBsaXN0W2krMV0gPSBxOwogICAgICAgICAgICAgICAgc3dhcCA9IHRy"
	"dWU7CiAgICAgICAgICAgIH0KICAgICAgICB9IC8vIGZvcgogICAgICAgIHQtLTsKCiAgIC"
	"AgICAgaWYgKCFzd2FwKSBicmVhazsKCiAgICAgICAgZm9yKHZhciBpID0gdDsgaSA+IGI7"
	"IC0taSkgewogICAgICAgICAgICBpZiAoIGNvbXBfZnVuYyhsaXN0W2ldLCBsaXN0W2ktMV"
	"0pIDwgMCApIHsKICAgICAgICAgICAgICAgIHZhciBxID0gbGlzdFtpXTsgbGlzdFtpXSA9"
	"IGxpc3RbaS0xXTsgbGlzdFtpLTFdID0gcTsKICAgICAgICAgICAgICAgIHN3YXAgPSB0cn"
	"VlOwogICAgICAgICAgICB9CiAgICAgICAgfSAvLyBmb3IKICAgICAgICBiKys7CgogICAg"
	"fSAvLyB3aGlsZShzd2FwKQogIH0gIAp9CgovKiAqKioqKioqKioqKioqKioqKioqKioqKi"
	"oqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioKICAgU3VwcG9y"
	"dGluZyBmdW5jdGlvbnM6IGJ1bmRsZWQgaGVyZSB0byBhdm9pZCBkZXBlbmRpbmcgb24gYS"
	"BsaWJyYXJ5CiAgICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq"
	"KioqKioqKioqKioqKioqKioqKioqKioqKiAqLwoKLy8gRGVhbiBFZHdhcmRzL01hdHRoaW"
	"FzIE1pbGxlci9Kb2huIFJlc2lnCgovKiBmb3IgTW96aWxsYS9PcGVyYTkgKi8KaWYgKGRv"
	"Y3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHsKICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdG"
	"VuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLCBzb3J0dGFibGUuaW5pdCwgZmFsc2UpOwp9Cgov"
	"KiBmb3IgSW50ZXJuZXQgRXhwbG9yZXIgKi8KLypAY2Nfb24gQCovCi8qQGlmIChAX3dpbj"
	"MyKQogICAgZG9jdW1lbnQud3JpdGUoIjxzY3JpcHQgaWQ9X19pZV9vbmxvYWQgZGVmZXIg"
	"c3JjPWphdmFzY3JpcHQ6dm9pZCgwKT48XC9zY3JpcHQ+Iik7CiAgICB2YXIgc2NyaXB0ID"
	"0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIl9faWVfb25sb2FkIik7CiAgICBzY3JpcHQu"
	"b25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7CiAgICAgICAgaWYgKHRoaXMucm"
	"VhZHlTdGF0ZSA9PSAiY29tcGxldGUiKSB7CiAgICAgICAgICAgIHNvcnR0YWJsZS5pbml0"
	"KCk7IC8vIGNhbGwgdGhlIG9ubG9hZCBoYW5kbGVyCiAgICAgICAgfQogICAgfTsKLypAZW"
	"5kIEAqLwoKLyogZm9yIFNhZmFyaSAqLwppZiAoL1dlYktpdC9pLnRlc3QobmF2aWdhdG9y"
	"LnVzZXJBZ2VudCkpIHsgLy8gc25pZmYKICAgIHZhciBfdGltZXIgPSBzZXRJbnRlcnZhbC"
	"hmdW5jdGlvbigpIHsKICAgICAgICBpZiAoL2xvYWRlZHxjb21wbGV0ZS8udGVzdChkb2N1"
	"bWVudC5yZWFkeVN0YXRlKSkgewogICAgICAgICAgICBzb3J0dGFibGUuaW5pdCgpOyAvLy"
	"BjYWxsIHRoZSBvbmxvYWQgaGFuZGxlcgogICAgICAgIH0KICAgIH0sIDEwKTsKfQoKLyog"
	"Zm9yIG90aGVyIGJyb3dzZXJzICovCndpbmRvdy5vbmxvYWQgPSBzb3J0dGFibGUuaW5pdD"
	"sKCi8vIHdyaXR0ZW4gYnkgRGVhbiBFZHdhcmRzLCAyMDA1Ci8vIHdpdGggaW5wdXQgZnJv"
	"bSBUaW5vIFppamRlbCwgTWF0dGhpYXMgTWlsbGVyLCBEaWVnbyBQZXJpbmkKCi8vIGh0dH"
	"A6Ly9kZWFuLmVkd2FyZHMubmFtZS93ZWJsb2cvMjAwNS8xMC9hZGQtZXZlbnQvCgpmdW5j"
	"dGlvbiBkZWFuX2FkZEV2ZW50KGVsZW1lbnQsIHR5cGUsIGhhbmRsZXIpIHsKCWlmIChlbG"
	"VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHsKCQllbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIo"
	"dHlwZSwgaGFuZGxlciwgZmFsc2UpOwoJfSBlbHNlIHsKCQkvLyBhc3NpZ24gZWFjaCBldm"
	"VudCBoYW5kbGVyIGEgdW5pcXVlIElECgkJaWYgKCFoYW5kbGVyLiQkZ3VpZCkgaGFuZGxl"
	"ci4kJGd1aWQgPSBkZWFuX2FkZEV2ZW50Lmd1aWQrKzsKCQkvLyBjcmVhdGUgYSBoYXNoIH"
	"RhYmxlIG9mIGV2ZW50IHR5cGVzIGZvciB0aGUgZWxlbWVudAoJCWlmICghZWxlbWVudC5l"
	"dmVudHMpIGVsZW1lbnQuZXZlbnRzID0ge307CgkJLy8gY3JlYXRlIGEgaGFzaCB0YWJsZS"
	"BvZiBldmVudCBoYW5kbGVycyBmb3IgZWFjaCBlbGVtZW50L2V2ZW50IHBhaXIKCQl2YXIg"
	"aGFuZGxlcnMgPSBlbGVtZW50LmV2ZW50c1t0eXBlXTsKCQlpZiAoIWhhbmRsZXJzKSB7Cg"
	"kJCWhhbmRsZXJzID0gZWxlbWVudC5ldmVudHNbdHlwZV0gPSB7fTsKCQkJLy8gc3RvcmUg"
	"dGhlIGV4aXN0aW5nIGV2ZW50IGhhbmRsZXIgKGlmIHRoZXJlIGlzIG9uZSkKCQkJaWYgKG"
	"VsZW1lbnRbIm9uIiArIHR5cGVdKSB7CgkJCQloYW5kbGVyc1swXSA9IGVsZW1lbnRbIm9u"
	"IiArIHR5cGVdOwoJCQl9CgkJfQoJCS8vIHN0b3JlIHRoZSBldmVudCBoYW5kbGVyIGluIH"
	"RoZSBoYXNoIHRhYmxlCgkJaGFuZGxlcnNbaGFuZGxlci4kJGd1aWRdID0gaGFuZGxlcjsK"
	"CQkvLyBhc3NpZ24gYSBnbG9iYWwgZXZlbnQgaGFuZGxlciB0byBkbyBhbGwgdGhlIHdvcm"
	"sKCQllbGVtZW50WyJvbiIgKyB0eXBlXSA9IGhhbmRsZUV2ZW50OwoJfQp9OwovLyBhIGNv"
	"dW50ZXIgdXNlZCB0byBjcmVhdGUgdW5pcXVlIElEcwpkZWFuX2FkZEV2ZW50Lmd1aWQgPS"
	"AxOwoKZnVuY3Rpb24gcmVtb3ZlRXZlbnQoZWxlbWVudCwgdHlwZSwgaGFuZGxlcikgewoJ"
	"aWYgKGVsZW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcikgewoJCWVsZW1lbnQucmVtb3ZlRX"
	"ZlbnRMaXN0ZW5lcih0eXBlLCBoYW5kbGVyLCBmYWxzZSk7Cgl9IGVsc2UgewoJCS8vIGRl"
	"bGV0ZSB0aGUgZXZlbnQgaGFuZGxlciBmcm9tIHRoZSBoYXNoIHRhYmxlCgkJaWYgKGVsZW"
	"1lbnQuZXZlbnRzICYmIGVsZW1lbnQuZXZlbnRzW3R5cGVdKSB7CgkJCWRlbGV0ZSBlbGVt"
	"ZW50LmV2ZW50c1t0eXBlXVtoYW5kbGVyLiQkZ3VpZF07CgkJfQoJfQp9OwoKZnVuY3Rpb2"
	"4gaGFuZGxlRXZlbnQoZXZlbnQpIHsKCXZhciByZXR1cm5WYWx1ZSA9IHRydWU7CgkvLyBn"
	"cmFiIHRoZSBldmVudCBvYmplY3QgKElFIHVzZXMgYSBnbG9iYWwgZXZlbnQgb2JqZWN0KQ"
	"oJZXZlbnQgPSBldmVudCB8fCBmaXhFdmVudCgoKHRoaXMub3duZXJEb2N1bWVudCB8fCB0"
	"aGlzLmRvY3VtZW50IHx8IHRoaXMpLnBhcmVudFdpbmRvdyB8fCB3aW5kb3cpLmV2ZW50KT"
	"sKCS8vIGdldCBhIHJlZmVyZW5jZSB0byB0aGUgaGFzaCB0YWJsZSBvZiBldmVudCBoYW5k"
	"bGVycwoJdmFyIGhhbmRsZXJzID0gdGhpcy5ldmVudHNbZXZlbnQudHlwZV07CgkvLyBleG"
	"VjdXRlIGVhY2ggZXZlbnQgaGFuZGxlcgoJZm9yICh2YXIgaSBpbiBoYW5kbGVycykgewoJ"
	"CXRoaXMuJCRoYW5kbGVFdmVudCA9IGhhbmRsZXJzW2ldOwoJCWlmICh0aGlzLiQkaGFuZG"
	"xlRXZlbnQoZXZlbnQpID09PSBmYWxzZSkgewoJCQlyZXR1cm5WYWx1ZSA9IGZhbHNlOwoJ"
	"CX0KCX0KCXJldHVybiByZXR1cm5WYWx1ZTsKfTsKCmZ1bmN0aW9uIGZpeEV2ZW50KGV2ZW"
	"50KSB7CgkvLyBhZGQgVzNDIHN0YW5kYXJkIGV2ZW50IG1ldGhvZHMKCWV2ZW50LnByZXZl"
	"bnREZWZhdWx0ID0gZml4RXZlbnQucHJldmVudERlZmF1bHQ7CglldmVudC5zdG9wUHJvcG"
	"FnYXRpb24gPSBmaXhFdmVudC5zdG9wUHJvcGFnYXRpb247CglyZXR1cm4gZXZlbnQ7Cn07"
	"CmZpeEV2ZW50LnByZXZlbnREZWZhdWx0ID0gZnVuY3Rpb24oKSB7Cgl0aGlzLnJldHVybl"
	"ZhbHVlID0gZmFsc2U7Cn07CmZpeEV2ZW50LnN0b3BQcm9wYWdhdGlvbiA9IGZ1bmN0aW9u"
	"KCkgewogIHRoaXMuY2FuY2VsQnViYmxlID0gdHJ1ZTsKfQoKLy8gRGVhbidzIGZvckVhY2"
	"g6IGh0dHA6Ly9kZWFuLmVkd2FyZHMubmFtZS9iYXNlL2ZvckVhY2guanMKLyoKCWZvckVh"
	"Y2gsIHZlcnNpb24gMS4wCglDb3B5cmlnaHQgMjAwNiwgRGVhbiBFZHdhcmRzCglMaWNlbn"
	"NlOiBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBo"
	"cAoqLwoKLy8gYXJyYXktbGlrZSBlbnVtZXJhdGlvbgppZiAoIUFycmF5LmZvckVhY2gpIH"
	"sgLy8gbW96aWxsYSBhbHJlYWR5IHN1cHBvcnRzIHRoaXMKCUFycmF5LmZvckVhY2ggPSBm"
	"dW5jdGlvbihhcnJheSwgYmxvY2ssIGNvbnRleHQpIHsKCQlmb3IgKHZhciBpID0gMDsgaS"
	"A8IGFycmF5Lmxlbmd0aDsgaSsrKSB7CgkJCWJsb2NrLmNhbGwoY29udGV4dCwgYXJyYXlb"
	"aV0sIGksIGFycmF5KTsKCQl9Cgl9Owp9CgovLyBnZW5lcmljIGVudW1lcmF0aW9uCkZ1bm"
	"N0aW9uLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24ob2JqZWN0LCBibG9jaywgY29u"
	"dGV4dCkgewoJZm9yICh2YXIga2V5IGluIG9iamVjdCkgewoJCWlmICh0eXBlb2YgdGhpcy"
	"5wcm90b3R5cGVba2V5XSA9PSAidW5kZWZpbmVkIikgewoJCQlibG9jay5jYWxsKGNvbnRl"
	"eHQsIG9iamVjdFtrZXldLCBrZXksIG9iamVjdCk7CgkJfQoJfQp9OwoKLy8gY2hhcmFjdG"
	"VyIGVudW1lcmF0aW9uClN0cmluZy5mb3JFYWNoID0gZnVuY3Rpb24oc3RyaW5nLCBibG9j"
	"aywgY29udGV4dCkgewoJQXJyYXkuZm9yRWFjaChzdHJpbmcuc3BsaXQoIiIpLCBmdW5jdG"
	"lvbihjaHIsIGluZGV4KSB7CgkJYmxvY2suY2FsbChjb250ZXh0LCBjaHIsIGluZGV4LCBz"
	"dHJpbmcpOwoJfSk7Cn07CgovLyBnbG9iYWxseSByZXNvbHZlIGZvckVhY2ggZW51bWVyYX"
	"Rpb24KdmFyIGZvckVhY2ggPSBmdW5jdGlvbihvYmplY3QsIGJsb2NrLCBjb250ZXh0KSB7"
	"CglpZiAob2JqZWN0KSB7CgkJdmFyIHJlc29sdmUgPSBPYmplY3Q7IC8vIGRlZmF1bHQKCQ"
	"lpZiAob2JqZWN0IGluc3RhbmNlb2YgRnVuY3Rpb24pIHsKCQkJLy8gZnVuY3Rpb25zIGhh"
	"dmUgYSAibGVuZ3RoIiBwcm9wZXJ0eQoJCQlyZXNvbHZlID0gRnVuY3Rpb247CgkJfSBlbH"
	"NlIGlmIChvYmplY3QuZm9yRWFjaCBpbnN0YW5jZW9mIEZ1bmN0aW9uKSB7CgkJCS8vIHRo"
	"ZSBvYmplY3QgaW1wbGVtZW50cyBhIGN1c3RvbSBmb3JFYWNoIG1ldGhvZCBzbyB1c2UgdG"
	"hhdAoJCQlvYmplY3QuZm9yRWFjaChibG9jaywgY29udGV4dCk7CgkJCXJldHVybjsKCQl9"
	"IGVsc2UgaWYgKHR5cGVvZiBvYmplY3QgPT0gInN0cmluZyIpIHsKCQkJLy8gdGhlIG9iam"
	"VjdCBpcyBhIHN0cmluZwoJCQlyZXNvbHZlID0gU3RyaW5nOwoJCX0gZWxzZSBpZiAodHlw"
	"ZW9mIG9iamVjdC5sZW5ndGggPT0gIm51bWJlciIpIHsKCQkJLy8gdGhlIG9iamVjdCBpcy"
	"BhcnJheS1saWtlCgkJCXJlc29sdmUgPSBBcnJheTsKCQl9CgkJcmVzb2x2ZS5mb3JFYWNo"
	"KG9iamVjdCwgYmxvY2ssIGNvbnRleHQpOwoJfQp9OwoK";

} } // end namespaces